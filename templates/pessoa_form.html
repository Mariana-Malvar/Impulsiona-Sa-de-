{% load static %}

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Impulsiona Saúde</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/estilo.css' %}">
</head>
<body>

    <!-- PARTE 1: FORMULÁRIO DE CADASTRO -->
    <h2>Cadastro de Voluntários</h2>
    
    {% if messages %}
        {% for message in messages %}
            <p style="color: green; font-weight: bold;">{{ message }}</p>
        {% endfor %}
    {% endif %}

    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Salvar Informações</button>
    </form>

    <hr>

    <!-- PARTE 2: LISTAGEM DE QUEM JÁ FOI SALVO -->
    <h2>Voluntários Cadastrados</h2>
    <table border="1" style="width:100%; border-collapse: collapse; margin-top: 10px;">
        <thead>
            <tr style="background-color: #eee;">
                <th>Nome</th>
                <th>CPF</th>
                <th>E-mail</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for p in pessoas %}
            <tr>
                <td>{{ p.nome }}</td>
                <td>{{ p.cpf }}</td>
                <td>{{ p.email }}</td>
                <td>
    <!-- Link para carregar os dados no formulário lá em cima -->
    <a href="{% url 'editar' p.id %}">Editar</a> | 
    
    <!-- Link para apagar o registro com confirmação -->
    <a href="{% url 'excluir' p.id %}" 
       style="color: red;" 
       onclick="return confirm('Tem certeza que deseja excluir {{ p.nome }}?')">
       Excluir
    </a>
</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align: center;">Nenhum voluntário cadastrado ainda.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>


    <!-- Importando o jQuery e o Plugin de Máscara -->
<script src="https://code.jquery.com"></script>
<script src="https://cdnjs.cloudflare.com"></script>

<script>
    $(document).ready(function(){
        // Máscara para CPF: 000.000.000-00
        $('input[name="cpf"]').mask('000.000.000-00');
        
        // Máscara para Telefone: (00) 00000-0000
        $('input[name="contato"]').mask('(00) 00000-0000');
        
        // Máscara para CRM (exemplo numérico): 000000-0/AA
        // Se o CRM variar muito, você pode deixar livre ou usar:
        $('input[name="crm"]').mask('00000000/AA', {
            translation: { 'A': {pattern: /[A-Z]/} }
        });
    });
</script>

</body>
</html>
